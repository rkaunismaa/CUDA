# Generated by ChatGPT 4o
# https://chatgpt.com/c/8a39f629-37df-4d91-be34-95285007424d
# Sunday, June 9, 2024

# Makefile for a CUDA program in the current directory
#
# Usage:
#   make             - Build the program with the default name (my_cuda_program)
#   make NAME=<name> - Build the program with the specified name
#   make clean       - Clean up the build files (object files and the executable)
#
# Example:
#   make NAME=cuda_app  - Build the program and name the executable cuda_app
#
# Compiler
NVCC := /usr/local/cuda/bin/nvcc

# Compiler flags for debug mode for Ampere GPU (compute capability 8.0)
NVCCFLAGS := -G -O0 -arch=sm_80

# Name of the program (can be passed as a variable)
NAME ?= my_cuda_program

# Automatically find the CUDA source file in the current directory
SRC := $(wildcard *.cu)
OBJ := $(patsubst %.cu, %.o, $(SRC))
TARGET := $(NAME)

# Default target
all: $(TARGET)

# Build the target
$(TARGET): $(OBJ)
	$(NVCC) $(NVCCFLAGS) -o $@ $^

# Compile CUDA source file to object file
%.o: %.cu
	$(NVCC) $(NVCCFLAGS) -c -o $@ $<

# Clean up
clean:
	rm -f $(OBJ) $(TARGET)

# Phony targets
.PHONY: all clean

